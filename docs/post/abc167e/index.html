<!DOCTYPE html>
<html lang="ja">
<head>





<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>ABC167E - Colorful Blocks - InTheDayDream</title>
<meta name="description" content="">

<meta name="author" content="">

<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
<link rel="alternate" href="/index.xml?c=796f75cebf9b25ab0e68fba57197e565ef4b1ad3" type="application/rss+xml" title="RSS" />
<meta property="og:title" content="ABC167E - Colorful Blocks - InTheDayDream">
</meta>
<meta property="og:url" content="http://inthebloom.github.io/post/abc167e/">
<meta property="og:type" content="article">
<meta property="og:site_name" content="InTheDayDream">
<meta property="og:description" content="">

<meta property="og:image" content="http://inthebloom.github.io//images/featured_image.jpg">

<meta name="twitter:card" content="summary_large_image" /></meta>
<meta name="twitter:site" content="@UU9782wsEdANDhp"></meta>
<meta name="twitter:creator" content="@UU9782wsEdANDhp"></meta>
<meta name="twitter:title" content="ABC167E - Colorful Blocks - InTheDayDream"></meta>
<meta name="twitter:url" content="http://inthebloom.github.io/post/abc167e/"></meta>
<meta name="twitter:description" content=""></meta>

<meta property="og:image" content="http://inthebloom.github.io//images/featured_image.jpg">


<link rel="stylesheet" href="/css/main.css?c=796f75cebf9b25ab0e68fba57197e565ef4b1ad3">
<link rel="stylesheet" href="/css/color.css?c=796f75cebf9b25ab0e68fba57197e565ef4b1ad3">


<link rel="stylesheet" href="/css/custom.css?c=796f75cebf9b25ab0e68fba57197e565ef4b1ad3">



</head>

<body class="theme-default">





<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js" integrity="sha384-cpW21h6RZv/phavutF+AuVYrr+dA8xD9zs6FwLpaCct6O9ctzYFfFr4dgmgccOTx" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
          
          
          delimiters: [
              {left: '$$', right: '$$', display: true},
              {left: '$', right: '$', display: false},
              
              
          ],
          
          throwOnError : false
        });
    });
</script>



<div id="content-header" class="title">
  
  <a class="site-title" href="/">InTheDayDream</a>
  
  <span class="site-sub-title"></span>

  

  <div id="main-menu-nav">
    <div id="main-menu-nav-items">
      
        <div class="nav-item"><a href="/">Home</a></div>
      
        <div class="nav-item"><a href="/tags/">Tags</a></div>
      
        <div class="nav-item"><a href="/archives/">Archives</a></div>
      
        <div class="nav-item"><a href="/about/">About</a></div>
      
        <div class="nav-item"><a href="/search/">Search</a></div>
      
    </div>
  </div>
</div>
<div id="content" class="main">




<h1>ABC167E - Colorful Blocks</h1>

<span class="sub">Published on 2024-01-03</span><br>
<span class="sub">Last Modified 2024-01-03</span>






<div style="padding: 0em 1em; margin-bottom: 5em; margin-top: 0.7em;">
    <p style="font-size: 1.3em;">Table Of Contents</p>
<nav id="TableOfContents">
  <ul>
    <li><a href="#問題概要">問題概要</a></li>
    <li><a href="#考察">考察</a></li>
    <li><a href="#実装例">実装例</a></li>
    <li><a href="#感想">感想</a></li>
  </ul>
</nav>
</div>



<h2 id="問題概要">問題概要</h2>
<p><a href="https://atcoder.jp/contests/abc167/tasks/abc167_e">問題へのリンク</a></p>
<p>$N$個の横一列に並んだブロック列に色を塗る。
色は整数で表され、$1$から$M$までの$M$種類ある。
必ずしもすべての色を使う必要はない。
隣り合うブロックが同じ色である箇所が$K$以下の色の塗り方の総数を$998244353$で割ったあまりを求めよ。</p>
<p>制約</p>
<ul>
<li>$1 \leq N, M \leq 2 \times 10^5$</li>
<li>$0 \leq K \leq N-1$</li>
</ul>
<h2 id="考察">考察</h2>
<p>dp解を考えてみよう。</p>
<div style="overflow: scroll;">
$dp[i][j] = (iブロック目まで塗って、隣り合うブロックが同じ色である場所がj個であるような塗り方の総数)$
</div>
とすれば、初期値
<ul>
<li>$dp[1][0] = M$</li>
</ul>
<p>更新</p>
<ul>
<li>$dp[i+1][j] = (M-1) * dp[i][j]$</li>
<li>$dp[i+1][j+1] = dp[i][j]$</li>
</ul>
<p>とすることで、$O(NK)$で解くことができる。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-d" data-lang="d"><span style="display:flex;"><span><span style="color:#f92672">import</span> std<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span> <span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> N<span style="color:#f92672">,</span> M<span style="color:#f92672">,</span> K<span style="color:#f92672">;</span> readln<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">(</span>N<span style="color:#f92672">,</span> M<span style="color:#f92672">,</span> K<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    solve<span style="color:#f92672">(</span>N<span style="color:#f92672">,</span> M<span style="color:#f92672">,</span> K<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">solve</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> N<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> M<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> K<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">long</span> MOD <span style="color:#f92672">=</span> <span style="color:#ae81ff">998244353</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">long</span><span style="color:#f92672">[][]</span> dp <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">long</span><span style="color:#f92672">[][](</span>N<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#f92672">,</span> K<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">foreach</span> <span style="color:#f92672">(</span>d<span style="color:#f92672">;</span> dp<span style="color:#f92672">)</span> d<span style="color:#f92672">[]</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    dp<span style="color:#f92672">[</span><span style="color:#ae81ff">1</span><span style="color:#f92672">][</span><span style="color:#ae81ff">0</span><span style="color:#f92672">]</span> <span style="color:#f92672">=</span> M<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">foreach</span> <span style="color:#f92672">(</span>i<span style="color:#f92672">;</span> <span style="color:#ae81ff">1.</span><span style="color:#f92672">.</span><span style="color:#a6e22e">N</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> j <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">;</span> j <span style="color:#f92672">&lt;=</span> K<span style="color:#f92672">;</span> j<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>            dp<span style="color:#f92672">[</span>i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#f92672">][</span>j<span style="color:#f92672">]</span> <span style="color:#f92672">+=</span> <span style="color:#f92672">(</span>M<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">)</span> <span style="color:#f92672">*</span> dp<span style="color:#f92672">[</span>i<span style="color:#f92672">][</span>j<span style="color:#f92672">]</span> <span style="color:#f92672">%</span> MOD<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>            dp<span style="color:#f92672">[</span>i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#f92672">][</span>j<span style="color:#f92672">]</span> <span style="color:#f92672">%=</span> MOD<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>j <span style="color:#f92672">&lt;</span> K<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>                dp<span style="color:#f92672">[</span>i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#f92672">][</span>j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#f92672">]</span> <span style="color:#f92672">+=</span> dp<span style="color:#f92672">[</span>i<span style="color:#f92672">][</span>j<span style="color:#f92672">];</span>
</span></span><span style="display:flex;"><span>                dp<span style="color:#f92672">[</span>i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#f92672">][</span>j<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#f92672">]</span> <span style="color:#f92672">%=</span> MOD<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">long</span> ans <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">foreach</span> <span style="color:#f92672">(</span>d<span style="color:#f92672">;</span> dp<span style="color:#f92672">[</span>N<span style="color:#f92672">])</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        ans <span style="color:#f92672">+=</span> d<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        ans <span style="color:#f92672">%=</span> MOD<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    writeln<span style="color:#f92672">(</span>ans<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">read</span> <span style="color:#f92672">(</span>T<span style="color:#f92672">...)</span> <span style="color:#f92672">(</span>string S<span style="color:#f92672">,</span> <span style="color:#66d9ef">ref</span> T args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">auto</span> buf <span style="color:#f92672">=</span> S<span style="color:#f92672">.</span><span style="color:#a6e22e">split</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">foreach</span> <span style="color:#f92672">(</span>i<span style="color:#f92672">,</span> <span style="color:#66d9ef">ref</span> arg<span style="color:#f92672">;</span> args<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        arg <span style="color:#f92672">=</span> buf<span style="color:#f92672">[</span>i<span style="color:#f92672">].</span><span style="color:#a6e22e">to</span><span style="color:#f92672">!(</span><span style="color:#66d9ef">typeof</span><span style="color:#f92672">(</span>arg<span style="color:#f92672">));</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>しかし、これでは間に合わない。
どうにか他の方法を考えよう。</p>
<p>こういうときは、他にうまいdpがあることは(この難易度帯では)少なく、
うまく数学で解くことが多い。</p>
<p>まず、隣り合う数を固定して(以下、$x$で考える)考える。
前から順番に色を塗っていくと考えると、$i$番目のブロックを塗る時、</p>
<ol>
<li>$i-1$番目のブロックと色が同じ時、隣り合う同じ色の場所の数は増える。(場合の数は$1$倍)</li>
<li>$i-1$番目のブロックと色が違う時、隣り合う同じ色の場所の数は変わらない。(場合の数は$M-1$倍)</li>
</ol>
<p>が$2$以上の$i$に対して<strong>常に成立</strong>することがわかる。
すなわち、最後まで塗った結果隣り合う色が同じ場所が$x$となるような塗り方は、
パターン1を$x$回、パターン2を$N-1-x$回経たようなものに限定されることになる。
また、$i=1$のときは何色で塗っても「一つ前」がいないので変わらなく、$M$通りになる。</p>
<p><strong>どこで</strong>パターン2を引くかの自由度を考えると、これは$\binom{N-1}{N-1-x}$通りであるから、最終的に場合の数は
上で議論したものにこれをかけた値、つまり</p>
<p>$$
M \times 1^{x} \times (M-1)^{N-1-x} \times \binom{N-1}{N-1-x} = M \times (M-1)^{N-1-x} \times \binom{N-1}{N-1-x}
$$</p>
<p>通りであり、解はこれを$0 \leq x \leq K$の範囲で合計したものになる。
適切な前計算の元、一つ固定した$x$に対して$O(\log N)$で求められるため、問題を$O(N \log N)$で解くことが出来た。</p>
<h2 id="実装例">実装例</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-d" data-lang="d"><span style="display:flex;"><span><span style="color:#f92672">import</span> std<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span> <span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> N<span style="color:#f92672">,</span> M<span style="color:#f92672">,</span> K<span style="color:#f92672">;</span> readln<span style="color:#f92672">.</span><span style="color:#a6e22e">read</span><span style="color:#f92672">(</span>N<span style="color:#f92672">,</span> M<span style="color:#f92672">,</span> K<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    solve<span style="color:#f92672">(</span>N<span style="color:#f92672">,</span> M<span style="color:#f92672">,</span> K<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">solve</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> N<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> M<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> K<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">/*</span>
</span></span><span style="display:flex;"><span>       前から順番に色を塗っていくことを考える<span style="color:#960050;background-color:#1e0010">。</span>
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">1</span>通りの現状維持<span style="color:#f92672">(</span>同じ色<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#f92672">)</span> or M<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>通りの色変え<span style="color:#f92672">(</span>同じ色維持<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>       をN<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>回迫られるという考え方で行く<span style="color:#960050;background-color:#1e0010">。</span>
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">*/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">long</span> MOD <span style="color:#f92672">=</span> <span style="color:#ae81ff">998244353</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">long</span><span style="color:#f92672">[]</span> fact <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">long</span><span style="color:#f92672">[](</span>N<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">long</span><span style="color:#f92672">[]</span> factInv <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#66d9ef">long</span><span style="color:#f92672">[](</span>N<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    fact<span style="color:#f92672">[</span><span style="color:#ae81ff">0</span><span style="color:#f92672">]</span> <span style="color:#f92672">=</span> factInv<span style="color:#f92672">[</span><span style="color:#ae81ff">0</span><span style="color:#f92672">]</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">foreach</span> <span style="color:#f92672">(</span>i<span style="color:#f92672">;</span> <span style="color:#ae81ff">1.</span><span style="color:#f92672">.</span><span style="color:#a6e22e">N</span><span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        fact<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> i<span style="color:#f92672">*</span>fact<span style="color:#f92672">[</span>i<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">]</span> <span style="color:#f92672">%</span> MOD<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        factInv<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> <span style="color:#f92672">=</span> modInv<span style="color:#f92672">(</span>fact<span style="color:#f92672">[</span>i<span style="color:#f92672">],</span> MOD<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">long</span> <span style="color:#a6e22e">comb</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> n<span style="color:#f92672">,</span> <span style="color:#66d9ef">int</span> k<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>n <span style="color:#f92672">&lt;</span> k<span style="color:#f92672">)</span> <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">long</span> res <span style="color:#f92672">=</span> fact<span style="color:#f92672">[</span>n<span style="color:#f92672">]</span> <span style="color:#f92672">*</span> factInv<span style="color:#f92672">[</span>k<span style="color:#f92672">]</span> <span style="color:#f92672">%</span> MOD<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        res <span style="color:#f92672">*=</span> factInv<span style="color:#f92672">[</span>n<span style="color:#f92672">-</span>k<span style="color:#f92672">];</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> res <span style="color:#f92672">%</span> MOD<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">long</span> ans <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">;</span> i <span style="color:#f92672">&lt;=</span> K<span style="color:#f92672">;</span> i<span style="color:#f92672">++)</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">/* i組の隣が同じ色のペアが存在する */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">long</span> add <span style="color:#f92672">=</span> M<span style="color:#f92672">*</span>comb<span style="color:#f92672">(</span>N<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">,</span> N<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>i<span style="color:#f92672">)</span> <span style="color:#f92672">%</span> MOD<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        add <span style="color:#f92672">*=</span> modPow<span style="color:#f92672">(</span>M<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">,</span> N<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>i<span style="color:#f92672">,</span> MOD<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span>        add <span style="color:#f92672">%=</span> MOD<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        ans <span style="color:#f92672">+=</span> add<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>        ans <span style="color:#f92672">%=</span> MOD<span style="color:#f92672">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    writeln<span style="color:#f92672">(</span>ans<span style="color:#f92672">);</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">}</span>
</span></span></code></pre></div><p>長いので、<code>ModPow</code>や<code>ModInv</code>など一部関数は省略している。</p>
<h2 id="感想">感想</h2>
<p>久しぶりに問題を見返したら全く解けなくて驚愕した。
折角なので復習の意味も込めて解法を理解し直してみた。</p>
<p>この手の問題ではやはり</p>
<ul>
<li>変数をできるだけ固定して考えてみる</li>
<li>単純化したバージョンの問題を考えてみる(2Dから1Dに落としてみるなど)</li>
</ul>
<p>などの基本テクニックを忘れないことももちろん、</p>
<ul>
<li>前から決めていくことにして考える(うまく行けば、今回のdp解のように部分問題の構造が見つかることも)</li>
<li>問題の操作を俯瞰的に見る</li>
<li>途中の「状態」を持たなくて良い方法を考える</li>
</ul>
<p>など色々あると思う。
今回の解法はどこで一つ前と違う色を入れても変わらず場合の数が$M-1$倍になることが重要なポイントであった。</p>
<p>いや、やっぱりこんなの誰が解けるんだ？でも1ヶ月前の自分は解けてるんだよな。。。</p>
<p>結局思考を再現できそうにない気がする。助けてくれ。</p>






<hr class="block-separater">




<div class="content-footer-item">
	Tags for this post:
	
	<a class="post-tag" href="/tags/%E7%AB%B6%E6%8A%80%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0/">競技プログラミング</a>
	
	<a class="post-tag" href="/tags/%E4%B8%80%E5%95%8F%E8%A7%A3%E8%AA%AC/">一問解説</a>
	
</div>







<div class="content-footer-item neighbor">
	
	<div class="prev-post">Prev: <a href="/post/2023-final/">2023年お疲れ様でした。</a></div>
	
	
	<div class="next-post">Next: <a href="/post/yukicoder2616/">No.2616 中央番目の中央値</a></div>
	
</div>











    
    
    
    <div class="related-tag-category-list">
        <h4 style="font-size: 1.3em;">Other posts tagged by "競技プログラミング"</h4>
        <ul class="post-list">
          
          <li class="post-item">
  <div class="post-date sub">2024-05-27</div>
  <div class="post-title"><a href="/post/dp-in-explicit-dag/">[覚書] 陽なDAG上のdpを楽に処理する</a></div>
  
</li>
          
          <li class="post-item">
  <div class="post-date sub">2024-05-18</div>
  <div class="post-title"><a href="/post/yukicoder2758/">No.2758 RDQ</a></div>
  
</li>
          
          <li class="post-item">
  <div class="post-date sub">2024-05-06</div>
  <div class="post-title"><a href="/post/abc352/">ABC352参加記録</a></div>
  
</li>
          
        </ul>
        <div class="more-area">
          
          <a class="more" href='/tags/%e7%ab%b6%e6%8a%80%e3%83%97%e3%83%ad%e3%82%b0%e3%83%a9%e3%83%9f%e3%83%b3%e3%82%b0/'>more ...</a>
          
      </div>
        </div>
    

    
    
    
    <div class="related-tag-category-list">
        <h4 style="font-size: 1.3em;">Other posts tagged by "一問解説"</h4>
        <ul class="post-list">
          
          <li class="post-item">
  <div class="post-date sub">2024-05-18</div>
  <div class="post-title"><a href="/post/yukicoder2758/">No.2758 RDQ</a></div>
  
</li>
          
          <li class="post-item">
  <div class="post-date sub">2024-04-10</div>
  <div class="post-title"><a href="/post/abc247f/">ABC247F - Cards</a></div>
  
</li>
          
          <li class="post-item">
  <div class="post-date sub">2024-04-08</div>
  <div class="post-title"><a href="/post/abc247e/">ABC247E - Max Min</a></div>
  
</li>
          
        </ul>
        <div class="more-area">
          
          <a class="more" href='/tags/%e4%b8%80%e5%95%8f%e8%a7%a3%e8%aa%ac/'>more ...</a>
          
      </div>
        </div>
    




<script src="/js/single.js"></script>





	</div><div id="content-footer" class="sub">
  
  <div class="credit">
    Power by <a href="https://gohugo.io">Hugo</a> /
    Theme <a href="https://github.com/michimani/simplog/">simplog</a> by <a href="https://github.com/michimani/">michimani</a>
  </div>
</div></body>

</html>